Object.create||(Object.create=function(){function t(){}return function(e){if(1!=arguments.length)throw new Error("Object.create implementation only accepts one parameter.");return t.prototype=e,new t}}()),Object.keys||(Object.keys=function(e,t,n){for(t in n=[],e)n.hasOwnProperty.call(e,t)&&n.push(t);return n}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(e){if(null==this)throw new TypeError;var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var r=2<=arguments.length?arguments[1]:void 0,o=0;o<n;o++)o in t&&e.call(r,t[o],o,t);return this}),Array.prototype.filter||(Array.prototype.filter=function(r,o){var i=[];return this.forEach(function(e,t,n){r.call(o||void 0,e,t,n)&&i.push(e)}),i}),Array.prototype.map||(Array.prototype.map=function(r,o){var i=[];return this.forEach(function(e,t,n){i.push(r.call(o||void 0,e,t,n))}),i}),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),"object"!=typeof window||"object"!=typeof window.location||window.location.assign||(window.location.assign=function(e){window.location=e}),Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");function t(){}function n(){return i.apply(this instanceof t?this:e||window,o.concat(r.call(arguments)))}var r=[].slice,o=r.call(arguments,1),i=this;return t.prototype=this.prototype,n.prototype=new t,n});var hello=function(e){return hello.use(e)};hello.utils={extend:function(n){return Array.prototype.slice.call(arguments,1).forEach(function(e){if(Array.isArray(n)&&Array.isArray(e))Array.prototype.push.apply(n,e);else if(n&&(n instanceof Object||"object"==typeof n)&&e&&(e instanceof Object||"object"==typeof e)&&n!==e)for(var t in e)"__proto__"!==t&&"constructor"!==t&&(n[t]=hello.utils.extend(n[t],e[t]));else Array.isArray(e)&&(e=e.slice(0)),n=e}),n}},hello.utils.extend(hello,{settings:{redirect_uri:window.location.href.split("#")[0],response_type:"token",display:"popup",state:"",oauth_proxy:"https://auth-server.herokuapp.com/proxy",timeout:2e4,popup:{resizable:1,scrollbars:1,width:500,height:550},scope:["basic"],scope_map:{basic:""},default_service:null,force:null,page_uri:window.location.href},services:{},use:function(e){var t=Object.create(this);return t.settings=Object.create(this.settings),e&&(t.settings.default_service=e),t.utils.Event.call(t),t},init:function(e,t){var n,r=this.utils;if(!e)return this.services;for(n in e)e.hasOwnProperty(n)&&"object"!=typeof e[n]&&(e[n]={id:e[n]});return r.extend(this.services,e),t&&(r.extend(this.settings,t),"redirect_uri"in t)&&(this.settings.redirect_uri=r.url(t.redirect_uri).href),this},login:function(){var e=this,t=e.utils,n=t.error,r=t.Promise(),o=t.args({network:"s",options:"o",callback:"f"},arguments),i=t.diffKey(o.options,e.settings),s=o.options=t.merge(e.settings,o.options||{});function a(e,t){hello.emit(e,t)}if(s.popup=t.merge(e.settings.popup,o.options.popup||{}),o.network=o.network||e.settings.default_service,r.proxy.then(o.callback,o.callback),r.proxy.then(a.bind(this,"auth.login auth"),a.bind(this,"auth.failed auth")),"string"!=typeof o.network||!(o.network in e.services))return r.reject(n("invalid_network","The provided network was not recognized"));var c,l,u=e.services[o.network],p=t.globalEvent(function(e){e?"string"==typeof e&&(e=JSON.parse(e)):e=n("cancelled","The authentication was not completed"),e.error?r.reject(e):(t.store(e.network,e),r.fulfill({network:e.network,authResponse:e}))}),f=t.url(s.redirect_uri).href,h=u.oauth.response_type||s.response_type,i=(/\bcode\b/.test(h)&&!u.oauth.grant&&(h=h.replace(/\bcode\b/,"token")),o.qs=t.merge(i,{client_id:encodeURIComponent(u.id),response_type:encodeURIComponent(h),redirect_uri:encodeURIComponent(f),state:{client_id:u.id,network:o.network,display:s.display,callback:p,state:s.state,redirect_uri:f}}),t.store(o.network)),p=/[,\s]+/,d=e.settings.scope?[e.settings.scope.toString()]:[],m=t.merge(e.settings.scope_map,u.scope||{});if((s.scope&&d.push(s.scope.toString()),i&&"scope"in i&&i.scope instanceof String&&d.push(i.scope),d=d.join(",").split(p),d=t.unique(d).filter(g),o.qs.state.scope=d.join(","),d=(d=d.map(function(e){return e in m?m[e]:e})).join(",").split(p),d=t.unique(d).filter(g),o.qs.scope=d.join(u.scope_delim||","),!1===s.force)&&(i&&"access_token"in i&&i.access_token&&"expires"in i&&i.expires>(new Date).getTime()/1e3&&0===t.diff((i.scope||"").split(p),(o.qs.state.scope||"").split(p)).length))return r.fulfill({unchanged:!0,network:o.network,authResponse:i}),r;return"page"===s.display&&s.page_uri&&(o.qs.state.page_uri=t.url(s.page_uri).href),"login"in u&&"function"==typeof u.login&&u.login(o),(!/\btoken\b/.test(h)||parseInt(u.oauth.version,10)<2||"none"===s.display&&u.oauth.grant&&i&&i.refresh_token)&&(o.qs.state.oauth=u.oauth,o.qs.state.oauth_proxy=s.oauth_proxy),u.oauth.base64_state?o.qs.state=window.btoa(JSON.stringify(o.qs.state)):o.qs.state=encodeURIComponent(JSON.stringify(o.qs.state)),e=1===parseInt(u.oauth.version,10)?t.qs(s.oauth_proxy,o.qs,y):"none"===s.display&&u.oauth.grant&&i&&i.refresh_token?(o.qs.refresh_token=i.refresh_token,t.qs(s.oauth_proxy,o.qs,y)):t.qs(u.oauth.auth,o.qs,y),a("auth.init",o),"none"===s.display?t.iframe(e,f):"popup"===s.display?(c=t.popup(e,f,s.popup),l=setInterval(function(){var e;c&&!c.closed||(clearInterval(l),r.state)||(e=n("cancelled","Login has been cancelled"),(e=c?e:n("blocked","Popup was blocked")).network=o.network,r.reject(e))},100)):window.location=e,r.proxy;function y(e){return e}function g(e){return!!e}},logout:function(){var t=this.utils,e=t.error,n=t.Promise(),r=t.args({name:"s",options:"o",callback:"f"},arguments);function o(e,t){hello.emit(e,t)}if(r.options=r.options||{},n.proxy.then(r.callback,r.callback),n.proxy.then(o.bind(this,"auth.logout auth"),o.bind(this,"error")),r.name=r.name||this.settings.default_service,r.authResponse=t.store(r.name),!r.name||r.name in this.services)if(r.name&&r.authResponse){function i(e){t.store(r.name,null),n.fulfill(hello.utils.merge({network:r.name},e||{}))}var s={};if(r.options.force){var a=this.services[r.name].logout;if(a)if("string"==typeof(a="function"==typeof a?a(i,r):a))t.iframe(a),s.force=null,s.message="Logout success on providers site was indeterminate";else if(void 0===a)return n.proxy}i(s)}else n.reject(e("invalid_session","There was no session to remove"));else n.reject(e("invalid_network","The network was unrecognized"));return n.proxy},getAuthResponse:function(e){return(e=e||this.settings.default_service)&&e in this.services&&this.utils.store(e)||null},events:{}}),hello.utils.extend(hello.utils,{error:function(e,t){return{error:{code:e,message:t}}},qs:function(e,t,n){if(t)for(var r in n=n||encodeURIComponent,t){var o=new RegExp("([\\?\\&])"+r+"=[^\\&]*");e.match(o)&&(e=e.replace(o,"$1"+r+"="+n(t[r])),delete t[r])}return this.isEmpty(t)?e:e+(-1<e.indexOf("?")?"&":"?")+this.param(t,n)},param:function(e,t){var n,r,o={};if("string"==typeof e){if(t=t||decodeURIComponent,r=e.replace(/^[\#\?]/,"").match(/([^=\/\&]+)=([^\&]+)/g))for(var i=0;i<r.length;i++)o[(n=r[i].match(/([^=]+)=(.*)/))[1]]=t(n[2]);return o}t=t||encodeURIComponent;var s,a=e,o=[];for(s in a)a.hasOwnProperty(s)&&a.hasOwnProperty(s)&&o.push([s,"?"===a[s]?"?":t(a[s])].join("="));return o.join("&")},store:function(){for(var o,i,e=["localStorage","sessionStorage"],t=-1;e[++t];)try{(o=window[e[t]]).setItem("test"+t,t),o.removeItem("test"+t);break}catch(e){o=null}return o||(i=null,i=(o={getItem:function(e){e+="=";for(var t=document.cookie.split(";"),n=0;n<t.length;n++){var r=t[n].replace(/(^\s+|\s+$)/,"");if(r&&0===r.indexOf(e))return r.substr(e.length)}return i},setItem:function(e,t){i=t,document.cookie=e+"="+t}}).getItem("hello")),function(t,e,n){var r=function(){var e={};try{e=JSON.parse(o.getItem("hello"))||{}}catch(e){}return e}();if(t&&void 0===e)return r[t]||null;if(t&&null===e)try{delete r[t]}catch(e){r[t]=null}else{if(!t)return r;r[t]=e}return o.setItem("hello",JSON.stringify(r)),r||null}}(),append:function(e,t,n){var r="string"==typeof e?document.createElement(e):e;if("object"==typeof t)if("tagName"in t)n=t;else for(var o in t)if(t.hasOwnProperty(o))if("object"==typeof t[o])for(var i in t[o])t[o].hasOwnProperty(i)&&(r[o][i]=t[o][i]);else"html"===o?r.innerHTML=t[o]:/^on/.test(o)?r[o]=t[o]:r.setAttribute(o,t[o]);return"body"===n?function e(){document.body?document.body.appendChild(r):setTimeout(e,16)}():"object"==typeof n?n.appendChild(r):"string"==typeof n&&document.getElementsByTagName(n)[0].appendChild(r),r},iframe:function(e){this.append("iframe",{src:e,style:{position:"absolute",left:"-1000px",bottom:0,height:"1px",width:"1px"}},"body")},merge:function(){var e=Array.prototype.slice.call(arguments);return e.unshift({}),this.extend.apply(null,e)},args:function(e,t){var n,r={},o=0,i=null;for(i in e)if(e.hasOwnProperty(i))break;if(1===t.length&&"object"==typeof t[0]&&"o!"!=e[i])for(i in t[0])if(e.hasOwnProperty(i)&&i in e)return t[0];for(i in e)if(e.hasOwnProperty(i))if(n=typeof t[o],"function"==typeof e[i]&&e[i].test(t[o])||"string"==typeof e[i]&&(-1<e[i].indexOf("s")&&"string"==n||-1<e[i].indexOf("o")&&"object"==n||-1<e[i].indexOf("i")&&"number"==n||-1<e[i].indexOf("a")&&"object"==n||-1<e[i].indexOf("f")&&"function"==n))r[i]=t[o++];else if("string"==typeof e[i]&&-1<e[i].indexOf("!"))return!1;return r},url:function(e){var t;return e?window.URL&&URL instanceof Function&&0!==URL.length?new URL(e,window.location):((t=document.createElement("a")).href=e,t.cloneNode(!1)):window.location},diff:function(t,e){return e.filter(function(e){return-1===t.indexOf(e)})},diffKey:function(e,t){if(!e&&t)return e;var n,r={};for(n in e)n in t||(r[n]=e[n]);return r},unique:function(n){return Array.isArray(n)?n.filter(function(e,t){return n.indexOf(e)===t}):[]},isEmpty:function(e){if(e){if(Array.isArray(e))return!e.length;if("object"==typeof e)for(var t in e)if(e.hasOwnProperty(t))return!1}return!0},Promise:function(){function r(e){if(!(this instanceof r))return new r(e);this.id="Thenable/1.0.6",this.state=0,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],this.proxy={then:this.then.bind(this)},"function"==typeof e&&e.call(this,this.fulfill.bind(this),this.reject.bind(this))}r.prototype={fulfill:function(e){return t(this,1,"fulfillValue",e)},reject:function(e){return t(this,2,"rejectReason",e)},then:function(e,t){var n=new r;return this.onFulfilled.push(i(e,n,"fulfill")),this.onRejected.push(i(t,n,"reject")),o(this),n.proxy}};var t=function(e,t,n,r){return 0===e.state&&(e.state=t,e[n]=r,o(e)),e},o=function(e){1===e.state?n(e,"onFulfilled",e.fulfillValue):2===e.state&&n(e,"onRejected",e.rejectReason)},n=function(e,t,n){var r;0!==e[t].length&&(r=e[t],e[t]=[],e=function(){for(var e=0;e<r.length;e++)r[e](n)},"object"==typeof process&&"function"==typeof process.nextTick?process.nextTick(e):"function"==typeof setImmediate?setImmediate(e):setTimeout(e,0))},i=function(n,r,o){return function(e){if("function"!=typeof n)r[o].call(r,e);else{var t;try{t=n(e)}catch(e){return void r.reject(e)}s(r,t)}}},s=function(t,n){if(t===n||t.proxy===n)t.reject(new TypeError("cannot resolve promise with itself"));else{var e;if("object"==typeof n&&null!==n||"function"==typeof n)try{e=n.then}catch(e){return void t.reject(e)}if("function"==typeof e){var r=!1;try{e.call(n,function(e){r||(r=!0,e===n?t.reject(new TypeError("circular thenable chain")):s(t,e))},function(e){r||(r=!0,t.reject(e))})}catch(e){r||t.reject(e)}}else t.fulfill(n)}};return r}(),Event:function(){var i=/[\s\,]+/;return this.parent={events:this.events,findEvents:this.findEvents,parent:this.parent,utils:this.utils},this.events={},this.on=function(e,t){if(t&&"function"==typeof t)for(var n=e.split(i),r=0;r<n.length;r++)this.events[n[r]]=[t].concat(this.events[n[r]]||[]);return this},this.off=function(e,n){return this.findEvents(e,function(e,t){n&&this.events[e][t]!==n||(this.events[e][t]=null)}),this},this.emit=function(n){function e(e,t){r[r.length-1]="*"===e?n:e,this.events[e][t].apply(this,r)}for(var r=Array.prototype.slice.call(arguments,1),t=(r.push(n),this);t&&t.findEvents;)t.findEvents(n+",*",e),t=t.parent;return this},this.emitAfter=function(){var e=this,t=arguments;return setTimeout(function(){e.emit.apply(e,t)},0),this},this.findEvents=function(e,t){var n,r=e.split(i);for(n in this.events)if(this.events.hasOwnProperty(n)&&-1<r.indexOf(n))for(var o=0;o<this.events[n].length;o++)this.events[n][o]&&t.call(this,n,o)},this},globalEvent:function(e,t){return t=t||"_hellojs_"+parseInt(1e12*Math.random(),10).toString(36),window[t]=function(){try{e.apply(this,arguments)&&delete window[t]}catch(e){console.error(e)}},t},popup:function(e,t,n){var r,o,i=document.documentElement,s=(n.height&&void 0===n.top&&(o=void 0!==window.screenTop?window.screenTop:screen.top,r=screen.height||window.innerHeight||i.clientHeight,n.top=parseInt((r-n.height)/2,10)+o),n.width&&void 0===n.left&&(r=void 0!==window.screenLeft?window.screenLeft:screen.left,o=screen.width||window.innerWidth||i.clientWidth,n.left=parseInt((o-n.width)/2,10)+r),[]),i=(Object.keys(n).forEach(function(e){var t=n[e];s.push(e+(null!==t?"="+t:""))}),-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")&&(e=t+"#oauth_redirect="+encodeURIComponent(encodeURIComponent(e))),window.open(e,"_blank",s.join(",")));return i&&i.focus&&i.focus(),i},responseHandler:function(l,e){var t,n,i=this,r=l.location;function o(e){if(!e||"string"!=typeof e)return null;function t(e){try{return JSON.parse(e)}catch(e){return null}}var n=t(e);if(n)return n;var r=function(t){try{return decodeURIComponent(t)}catch(e){return t}}(e);if(n=t(r))return n;if(n=t(function(t){try{return unescape(t)}catch(e){return t}}(e)))return n;var o=e.replace(/&#34;/g,'"').replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&apos;/g,"'");if(n=t(o))return n;for(var i,s=[e,r,o],a=0;a<s.length;a++){var c=s[a];if(/^[A-Za-z0-9+/=_-]+$/.test(c)){c=c.replace(/-/g,"+").replace(/_/g,"/"),c=function(e){try{return l.atob(e)}catch(e){return null}}(c+Array((4-c.length%4)%4+1).join("="));if(c&&(n=t(c)))return n}}try{i=decodeURIComponent(unescape(e))}catch(e){i=null}return i&&(n=t(i))?n:null}function s(e){return/^https?:/.test(e)&&(!Object.prototype.hasOwnProperty.call(l,"HELLOJS_REDIRECT_URL")||e.match(l.HELLOJS_REDIRECT_URL))}function a(e,t,n){var r=e.callback,o=e.network;if(i.store(o,e),!("display"in e&&"page"===e.display)){if(n&&r&&r in n){try{delete e.callback}catch(e){}i.store(o,e);o=JSON.stringify(e);try{c(n,r)(o)}catch(e){}}u()}}function c(e,t){return 0!==t.indexOf("_hellojs_")?function(){throw"Could not execute callback "+t}:e[t]}function u(){if(l.frameElement)e.document.body.removeChild(l.frameElement);else{try{l.close()}catch(e){}l.addEventListener&&l.addEventListener("load",function(){l.close()})}}(n=i.param(r.search))&&n.state&&(n.code||n.oauth_token)?(t=o(n.state))?(n.redirect_uri=t.redirect_uri||r.href.replace(/[\?\#].*$/,""),s(t=i.qs(t.oauth_proxy,n))&&r.assign(t)):console.error("Could not decode state parameter"):(n=i.merge(i.param(r.search||""),i.param(r.hash||"")))&&"state"in n?((t=o(n.state))?i.extend(n,t):console.error("Could not decode state parameter"),"access_token"in n&&n.access_token&&n.network?(n.expires_in&&0!==parseInt(n.expires_in,10)||(n.expires_in=0),n.expires_in=parseInt(n.expires_in,10),n.expires=(new Date).getTime()/1e3+(n.expires_in||31536e3),a(n,0,e)):"error"in n&&n.error&&n.network?(n.error={code:n.error,message:n.error_message||n.error_description},a(n,0,e)):n.callback&&n.callback in e&&(t=!!("result"in n&&n.result)&&JSON.parse(n.result),c(e,n.callback)(t),u()),n.page_uri&&s(n.page_uri)&&r.assign(n.page_uri)):"oauth_redirect"in n&&s(t=decodeURIComponent(n.oauth_redirect))&&r.assign(t)}}),hello.utils.Event.call(hello),function(c){var l={},u={};c.on("auth.login, auth.logout",function(e){e&&"object"==typeof e&&e.network&&(l[e.network]=c.utils.store(e.network)||{})}),function e(){function t(e){c.emit("auth."+e,{network:n,authResponse:o})}var n,r=(new Date).getTime()/1e3;for(n in c.services)if(c.services.hasOwnProperty(n)&&c.services[n].id){var o=c.utils.store(n)||{},i=c.services[n],s=l[n]||{};if(o&&"callback"in o){var a=o.callback;try{delete o.callback}catch(e){}c.utils.store(n,o);try{window[a](o)}catch(e){}}o&&"expires"in o&&o.expires<r?!(a=i.refresh||o.refresh_token)||n in u&&!(u[n]<r)?a||n in u||(t("expired"),u[n]=!0):(c.emit("notice",n+" has expired trying to resignin"),c.login(n,{display:"none",force:!1}),u[n]=600+r):s.access_token===o.access_token&&s.expires===o.expires||(!o.access_token&&s.access_token?t("logout"):o.access_token&&!s.access_token?t("login"):o.expires!==s.expires&&t("update"),l[n]=o,n in u&&delete u[n])}setTimeout(e,1e3)}()}(hello),hello.api=function(){var e=this,r=e.utils,o=r.error,i=r.Promise(),s=r.args({path:"s!",query:"o",method:"s",data:"o",timeout:"i",callback:"f"},arguments),t=(s.method=(s.method||"get").toLowerCase(),s.headers=s.headers||{},s.query=s.query||{},"get"!==s.method&&"delete"!==s.method||(r.extend(s.query,s.data),s.data={}),s.data=s.data||{});if(i.then(s.callback,s.callback),!s.path)return i.reject(o("invalid_path","Missing the path parameter from the request"));s.path=s.path.replace(/^\/+/,"");var n=(s.path.split(/[\/\:]/,2)||[])[0].toLowerCase(),a=(n in e.services&&(s.network=n,n=new RegExp("^"+n+":?/?"),s.path=s.path.replace(n,"")),s.network=e.settings.default_service=s.network||e.settings.default_service,e.services[s.network]);if(!a)return i.reject(o("invalid_network","Could not match the service requested: "+s.network));if(s.method in a&&s.path in a[s.method]&&!1===a[s.method][s.path])return i.reject(o("invalid_path","The provided path is not available on the selected network"));s.oauth_proxy||(s.oauth_proxy=e.settings.oauth_proxy),"proxy"in s||(s.proxy=s.oauth_proxy&&a.oauth&&1===parseInt(a.oauth.version,10)),"timeout"in s||(s.timeout=e.settings.timeout),"formatResponse"in s||(s.formatResponse=!0),s.authResponse=e.getAuthResponse(s.network),s.authResponse&&s.authResponse.access_token&&(s.query.access_token=s.authResponse.access_token);var c,n=s.path,t=(s.options=r.clone(s.query),s.data=r.clone(t),a[{delete:"del"}[s.method]||s.method]||{});return"get"===s.method&&(c=n.split(/[\?#]/)[1])&&(r.extend(s.query,r.param(c)),n=n.replace(/\?.*?(#|$)/,"$1")),(c=n.match(/#(.+)/,""))?(n=n.split("#")[0],s.path=c[1]):n in t?n=t[s.path=n]:"default"in t&&(n=t.default),s.redirect_uri=e.settings.redirect_uri,s.xhr=a.xhr,s.jsonp=a.jsonp,s.form=a.form,"function"==typeof n?n(s,l):l(n),i.proxy;function l(e){(e=e.replace(/\@\{([a-z\_\-]+)(\|.*?)?\}/gi,function(e,t,n){var r=n?n.replace(/^\|/,""):"";return t in s.query?(r=s.query[t],delete s.query[t]):s.data&&t in s.data?(r=s.data[t],delete s.data[t]):n||i.reject(o("missing_attribute","The attribute "+t+" is missing from the request")),r})).match(/^https?:\/\//)||(e=a.base+e),s.url=e,r.request(s,function(e,t){var n;s.formatResponse?(e=!0===e?{success:!0}:e||{},"delete"===s.method&&(e=!e||r.isEmpty(e)?{success:!0}:e),(e=a.wrap&&(s.path in a.wrap||"default"in a.wrap)&&(n=s.path in a.wrap?s.path:"default",(new Date).getTime(),n=a.wrap[n](e,t,s))?n:e)&&"paging"in e&&e.paging.next&&("?"===e.paging.next[0]?e.paging.next=s.path+e.paging.next:e.paging.next+="#"+s.path),!e||"error"in e?i.reject(e):i.fulfill(e)):("object"==typeof t?400<=t.statusCode:"object"==typeof e&&"error"in e)?i.reject(e):i.fulfill(e)})}},hello.utils.extend(hello.utils,{request:function(t,n){var o=this,e=o.error;if(o.isEmpty(t.data)||"FileList"in window||!o.hasBinary(t.data)||(t.xhr=!1,t.jsonp=!1),this.request_cors(function(){return void 0===t.xhr||t.xhr&&("function"!=typeof t.xhr||t.xhr(t,t.query))}))s(t,function(e){e=o.xhr(t.method,e,t.headers,t.data,n);e.onprogress=t.onprogress||null,e.upload&&t.onuploadprogress&&(e.upload.onprogress=t.onuploadprogress)});else{var r,i=t.query;if(t.query=o.clone(t.query),t.callbackID=o.globalEvent(),!1!==t.jsonp){if(t.query.callback=t.callbackID,"function"==typeof t.jsonp&&t.jsonp(t,t.query),"get"===t.method)return void s(t,function(e){o.jsonp(e,n,t.callbackID,t.timeout)});t.query=i}if(!1!==t.form)if(t.query.redirect_uri=t.redirect_uri,t.query.state=JSON.stringify({callback:t.callbackID}),"function"==typeof t.form&&(r=t.form(t,t.query)),"post"===t.method&&!1!==r)return void s(t,function(e){o.post(e,t.data,r,n,t.callbackID,t.timeout)});n(e("invalid_request","There was no mechanism for handling this request"))}function s(e,t){e.authResponse&&e.authResponse.oauth&&1===parseInt(e.authResponse.oauth.version,10)&&(n=e.query.access_token,delete e.query.access_token,e.proxy=!0),!e.data||"get"!==e.method&&"delete"!==e.method||(o.extend(e.query,e.data),e.data=null);var n,r=o.qs(e.url,e.query);t(r=e.proxy?o.qs(e.oauth_proxy,{path:r,access_token:n||"",then:e.proxy_response_type||("get"===e.method.toLowerCase()?"redirect":"proxy"),method:e.method.toLowerCase(),suppress_response_codes:e.suppress_response_codes||!0}):r)}},request_cors:function(e){return"withCredentials"in new XMLHttpRequest&&e()},domInstance:function(e,t){var n="HTML"+(e||"").replace(/^[a-z]/,function(e){return e.toUpperCase()})+"Element";return!!t&&(window[n]?t instanceof window[n]:window.Element?t instanceof window.Element&&(!e||t.tagName&&t.tagName.toLowerCase()===e):!(t instanceof Object||t instanceof Array||t instanceof String||t instanceof Number)&&t.tagName&&t.tagName.toLowerCase()===e)},clone:function(e){if(null===e||"object"!=typeof e||e instanceof Date||"nodeName"in e||this.isBinary(e)||"function"==typeof FormData&&e instanceof FormData)return e;if(Array.isArray(e))return e.map(this.clone.bind(this));var t,n={};for(t in e)n[t]=this.clone(e[t]);return n},xhr:function(r,e,t,n,o){var i,s=new XMLHttpRequest,a=this.error,c=!1;if("blob"===r&&(c=r,r="GET"),r=r.toUpperCase(),s.onload=function(e){var t=s.response;try{t=JSON.parse(s.responseText)}catch(e){401===s.status&&(t=a("access_denied",s.statusText))}var n=function(e){var t,n={},r=/([a-z\-]+):\s?(.*);?/gi;for(;t=r.exec(e);)n[t[1]]=t[2];return n}(s.getAllResponseHeaders());n.statusCode=s.status,o(t||("GET"===r?a("empty_response","Could not get resource"):{}),n)},s.onerror=function(e){var t=s.responseText;try{t=JSON.parse(s.responseText)}catch(e){}o(t||a("access_denied","Could not get resource"))},"GET"===r||"DELETE"===r)n=null;else if(n&&"string"!=typeof n&&!(n instanceof FormData)&&!(n instanceof File)&&!(n instanceof Blob)){var l=new FormData;for(i in n)n.hasOwnProperty(i)&&(n[i]instanceof HTMLInputElement?"files"in n[i]&&0<n[i].files.length&&l.append(i,n[i].files[0]):n[i]instanceof Blob?l.append(i,n[i],n.name):l.append(i,n[i]));n=l}if(s.open(r,e,!0),c&&("responseType"in s?s.responseType=c:s.overrideMimeType("text/plain; charset=x-user-defined")),t)for(i in t)s.setRequestHeader(i,t[i]);return s.send(n),s},jsonp:function(e,t,n,r){function o(){a++||window.setTimeout(function(){t(l),c.removeChild(u)},0)}var i,s=this.error,a=0,c=document.getElementsByTagName("head")[0],l=s("server_error","server_error"),u=(n=this.globalEvent(function(e){return l=e,!0},n),e=e.replace(new RegExp("=\\?(&|$)"),"="+n+"$1"),this.append("script",{id:n,name:n,src:e,async:!0,onload:o,onerror:o,onreadystatechange:function(){/loaded|complete/i.test(this.readyState)&&o()}}));-1<window.navigator.userAgent.toLowerCase().indexOf("opera")&&(i=this.append("script",{text:"document.getElementById('"+n+"').onerror();"}),u.async=!1),r&&window.setTimeout(function(){l=s("timeout","timeout"),o()},r),c.appendChild(u),i&&c.appendChild(i)},post:function(e,t,n,r,o,i){function s(e){g++||r(e)}var a,c,l,u=this,p=u.error,f=document,h=null,d=[],m=0,y=null,g=0;u.globalEvent(s,o);try{c=f.createElement('<iframe name="'+o+'">')}catch(e){c=f.createElement("iframe")}if(c.name=o,c.id=o,c.style.display="none",n&&n.callbackonload&&(c.onload=function(){s({response:"posted",message:"Content was posted"})}),i&&setTimeout(function(){s(p("timeout","The post operation timed out"))},i),f.body.appendChild(c),u.domInstance("form",t)){for(h=t.form,m=0;m<h.elements.length;m++)h.elements[m]!==t&&h.elements[m].setAttribute("disabled",!0);t=h}if(u.domInstance("form",t))for(h=t,m=0;m<h.elements.length;m++)h.elements[m].disabled||"file"!==h.elements[m].type||(h.encoding=h.enctype="multipart/form-data",h.elements[m].setAttribute("name","file"));else{for(y in t)t.hasOwnProperty(y)&&u.domInstance("input",t[y])&&"file"===t[y].type&&((h=t[y].form).encoding=h.enctype="multipart/form-data");for(y in h||(h=f.createElement("form"),f.body.appendChild(h),a=h),t)if(t.hasOwnProperty(y)){var v=u.domInstance("input",t[y])||u.domInstance("textArea",t[y])||u.domInstance("select",t[y]);if(v&&t[y].form===h)v&&t[y].name!==y&&(t[y].setAttribute("name",y),t[y].name=y);else{var w=h.elements[y];if(l)for(w instanceof NodeList||(w=[w]),m=0;m<w.length;m++)w[m].parentNode.removeChild(w[m]);(l=f.createElement("input")).setAttribute("type","hidden"),l.setAttribute("name",y),v?l.value=t[y].value:u.domInstance(null,t[y])?l.value=t[y].innerHTML||t[y].innerText:l.value=t[y],h.appendChild(l)}}for(m=0;m<h.elements.length;m++)(l=h.elements[m]).name in t||!0===l.getAttribute("disabled")||(l.setAttribute("disabled",!0),d.push(l))}h.setAttribute("method","POST"),h.setAttribute("target",o),h.target=o,h.setAttribute("action",e),setTimeout(function(){h.submit(),setTimeout(function(){try{a&&a.parentNode.removeChild(a)}catch(e){try{console.error("HelloJS: could not remove iframe")}catch(e){}}for(var e=0;e<d.length;e++)d[e]&&(d[e].setAttribute("disabled",!1),d[e].disabled=!1)},0)},100)},hasBinary:function(e){for(var t in e)if(e.hasOwnProperty(t)&&this.isBinary(e[t]))return!0;return!1},isBinary:function(e){return e instanceof Object&&(this.domInstance("input",e)&&"file"===e.type||"FileList"in window&&e instanceof window.FileList||"File"in window&&e instanceof window.File||"Blob"in window&&e instanceof window.Blob)},toBlob:function(e){var t=/^data\:([^;,]+(\;charset=[^;,]+)?)(\;base64)?,/i,n=e.match(t);if(!n)return e;for(var r=atob(e.replace(t,"")),o=[],i=0;i<r.length;i++)o.push(r.charCodeAt(i));return new Blob([new Uint8Array(o)],{type:n[1]})}}),function(e){var t=e.api,n=e.utils;n.extend(n,{dataToJSON:function(e){var t=this,n=window,r=e.data;if(t.domInstance("form",r)?r=t.nodeListToJSON(r.elements):"NodeList"in n&&r instanceof NodeList?r=t.nodeListToJSON(r):t.domInstance("input",r)&&(r=t.nodeListToJSON([r])),("File"in n&&r instanceof n.File||"Blob"in n&&r instanceof n.Blob||"FileList"in n&&r instanceof n.FileList)&&(r={file:r}),!("FormData"in n&&r instanceof n.FormData))for(var o in r)if(r.hasOwnProperty(o))if("FileList"in n&&r[o]instanceof n.FileList)1===r[o].length&&(r[o]=r[o][0]);else{if(t.domInstance("input",r[o])&&"file"===r[o].type)continue;t.domInstance("input",r[o])||t.domInstance("select",r[o])||t.domInstance("textArea",r[o])?r[o]=r[o].value:t.domInstance(null,r[o])&&(r[o]=r[o].innerHTML||r[o].innerText)}return e.data=r},nodeListToJSON:function(e){for(var t={},n=0;n<e.length;n++){var r=e[n];!r.disabled&&r.name&&("file"===r.type?t[r.name]=r:t[r.name]=r.value||r.innerHTML)}return t}}),e.api=function(){var e=n.args({path:"s!",method:"s",data:"o",timeout:"i",callback:"f"},arguments);return e.data&&n.dataToJSON(e),t.call(this,e)}}(hello),hello.utils.responseHandler(window,window.opener||window.parent),"object"==typeof chrome&&"object"==typeof chrome.identity&&chrome.identity.launchWebAuthFlow&&function(){hello.utils.popup=function(e){return r(e,!0)},hello.utils.iframe=function(e){r(e,!1)},hello.utils.request_cors=function(e){return e(),!0};var n={};function r(e,t){var n={closed:!1};return chrome.identity.launchWebAuthFlow({url:e,interactive:t},function(e){void 0===e?n.closed=!0:(e={location:{assign:function(e){r(e,!1)},search:(e=hello.utils.url(e)).search,hash:e.hash,href:e.href},close:function(){}},hello.utils.responseHandler(e,window))}),n}chrome.storage.local.get("hello",function(e){n=e.hello||{}}),hello.utils.store=function(e,t){return 0===arguments.length?n:1===arguments.length?n[e]||null:t?(n[e]=t,chrome.storage.local.set({hello:n}),t):null===t?(delete n[e],chrome.storage.local.set({hello:n}),null):void 0}}(),function(){var s;/^file:\/{3}[^\/]/.test(window.location.href)&&window.cordova&&(hello.utils.iframe=function(e,t){hello.utils.popup(e,t,{hidden:"yes"})},s=hello.utils.popup,hello.utils.popup=function(e,t,n){var r,o,i=s.call(this,e,t,n);try{i&&i.addEventListener&&(r=hello.utils.url(t),o=r.origin||r.protocol+"//"+r.hostname,i.addEventListener("loadstart",function(e){var e=e.url;0===e.indexOf(o)&&(e={location:{assign:function(e){i.executeScript({code:'window.location.href = "'+e+';"'})},search:(e=hello.utils.url(e)).search,hash:e.hash,href:e.href},close:function(){if(i.close){i.close();try{i.closed=!0}catch(e){}}}},hello.utils.responseHandler(e,window))}))}catch(e){}return i})}(),"function"==typeof define&&define.amd&&define(function(){return hello}),"object"==typeof module&&module.exports&&(module.exports=hello);